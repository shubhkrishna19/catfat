{% comment %}
  Product Card Snippet
  Displays a product in a grid format with image, title, price, and quick add
  Uses the pink/coral color scheme: #ff6b9d, #e84a7f, #ff8e53
{% endcomment %}

{%- assign product = product -%}

{%- assign product_form_id = 'product-form-' | append: section.id | append: '-' | append: product.id -%}

<div class="product-card" js-product-card>
  <div class="product-card__media">
    <a href="{{ product.url }}" class="product-card__link">
      <div class="product-card__image-wrapper">
        {% if product.featured_media %}
          <img
            src="{{ product.featured_media | image_url: width: 533 }}"
            alt="{{ product.featured_media.alt | escape }}"
            class="product-card__image"
            loading="lazy"
            width="533"
            height="{{ 533 | divided_by: product.featured_media.aspect_ratio | floor }}"
          >
        {% else %}
          {{ 'product-1' | placeholder_svg_tag: 'product-card__image product-card__image--placeholder' }}
        {% endif %}
      </div>
    </a>

    {% render 'badge', product: product %}

    <div class="product-card__actions">
      {% if product.variants.size > 1 %}
        <a href="{{ product.url }}" class="product-card__quick-add button button--secondary">
          <span>{{ 'products.product.select_options' | t }}</span>
        </a>
      {% else %}
        <product-form>
          {%- form 'product', product, id: product_form_id, class: 'product-form', novalidate: 'novalidate', data-type: 'add-to-cart-form' -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" disabled>
            <button
              type="submit"
              name="add"
              class="product-card__quick-add button button--primary"
              {% if product.selected_or_first_available_variant.available == false %}
                disabled
              {% endif %}
            >
              <span>
                {% if product.selected_or_first_available_variant.available %}
                  {{ 'products.product.add_to_cart' | t }}
                {% else %}
                  {{ 'products.product.sold_out' | t }}
                {% endif %}
              </span>
            </button>
          {%- endform -%}
        </product-form>
      {% endif %}
    </div>
  </div>

  <div class="product-card__info">
    <div class="product-card__details">
      <a href="{{ product.url }}" class="product-card__title">
        {{ product.title | escape }}
      </a>

      <div class="product-card__price">
        {% render 'price', product: product, use_variant: true, show_badges: false %}
      </div>
    </div>

    {% if product.options_by_name['Color'] or product.options_by_name['Size'] %}
      <div class="product-card__options">
        {% if product.options_by_name['Color'] %}
          <span class="product-card__option">
            {{ product.options_by_name['Color'].values | join: ', ' }}
          </span>
        {% endif %}
        {% if product.options_by_name['Size'] %}
          <span class="product-card__option">
            {{ product.options_by_name['Size'].values | join: ', ' }}
          </span>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<style>
  .product-card {
    position: relative;
    display: flex;
    flex-direction: column;
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(255, 107, 157, 0.15);
  }

  .product-card__media {
    position: relative;
    overflow: hidden;
  }

  .product-card__image-wrapper {
    position: relative;
    aspect-ratio: 1;
    overflow: hidden;
    background: #f5f5f5;
  }

  .product-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .product-card:hover .product-card__image {
    transform: scale(1.05);
  }

  .product-card__actions {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 12px;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
    background: linear-gradient(to top, rgba(255,255,255,0.95), rgba(255,255,255,0));
  }

  .product-card:hover .product-card__actions {
    opacity: 1;
    transform: translateY(0);
  }

  .product-card__quick-add {
    width: 100%;
    padding: 12px 16px;
    font-size: 14px;
    font-weight: 600;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .product-card__quick-add.button--primary {
    background: linear-gradient(135deg, #ff6b9d 0%, #e84a7f 100%);
    color: #fff;
  }

  .product-card__quick-add.button--primary:hover {
    background: linear-gradient(135deg, #ff8e53 0%, #ff6b9d 100%);
    box-shadow: 0 4px 12px rgba(255, 107, 157, 0.4);
  }

  .product-card__quick-add.button--secondary {
    background: #fff;
    color: #e84a7f;
    border: 2px solid #e84a7f;
  }

  .product-card__quick-add.button--secondary:hover {
    background: #e84a7f;
    color: #fff;
  }

  .product-card__info {
    padding: 16px;
  }

  .product-card__title {
    font-size: 16px;
    font-weight: 600;
    color: #1a1a1a;
    text-decoration: none;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    transition: color 0.2s ease;
  }

  .product-card__title:hover {
    color: #e84a7f;
  }

  .product-card__price {
    margin-top: 8px;
    font-size: 15px;
  }

  .product-card__price .price {
    color: #ff6b9d;
  }

  .product-card__price .price--sale {
    color: #e84a7f;
  }

  .product-card__price .price__regular .price-item {
    color: #1a1a1a;
  }

  .product-card__price .price__sale .price-item--regular {
    color: #999;
    text-decoration: line-through;
  }

  .product-card__options {
    margin-top: 8px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .product-card__option {
    font-size: 12px;
    color: #666;
    background: #f5f5f5;
    padding: 4px 8px;
    border-radius: 4px;
  }
</style>

{% schema %}
{
  "name": "Product Card",
  "settings": [
    {
      "type": "header",
      "content": "Product Card Settings"
    },
    {
      "type": "checkbox",
      "id": "show_quick_add",
      "default": true,
      "label": "Show quick add button"
    },
    {
      "type": "checkbox",
      "id": "show_badges",
      "default": true,
      "label": "Show sale badges"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "portrait",
          "label": "Portrait"
        },
        {
          "value": "square",
          "label": "Square"
        },
        {
          "value": "landscape",
          "label": "Landscape"
        }
      ],
      "default": "square",
      "label": "Image ratio"
    }
  ]
}
{% endschema %}
